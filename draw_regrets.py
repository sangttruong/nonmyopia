import pickle
import numpy as np
from _5_evalplot import draw_metric
import sys

datasets = sys.argv[1:]

algos = ["Non-myopic HES", 
         "Myopic HES", 
         "Non-myopic MST",
         "SR",
         "EI", 
         "PI", 
         "UCB", 
         "KG"
]

algos_name = [
    "HES", "HES", 
    "qMSL", "qSR",
    "qEI", "qPI", 
    "qUCB", "qKG"
]

seeds = [1,2,3,4,5,6,7,8,9,10]

# Init num_initial_points and num_steps
num_steps = {
    "SynGP": 30,
    "HolderTable": 30,
    "EggHolder": 16,
    "Alpine": 30
}

num_initial_points = {
    "SynGP": 10,
    "HolderTable": 10,
    "EggHolder": 6,
    "Alpine": 10
}

metric_files = {
    "SynGP": {
        "Non-myopic HES": {
            9: "exp_HES_SynGP_15_53",
            5: "exp_HES_SynGP_15_54",
            4: "exp_HES_SynGP_15_55",
            3: "exp_HES_SynGP_15_56",
            1: "exp_HES_SynGP_15_57",
            10: "exp_HES_SynGP_15_58",
            6: "exp_HES_SynGP_15_59",
            8: "exp_HES_SynGP_15_60",
            2: "exp_HES_SynGP_15_61",
            7: "exp_HES_SynGP_15_62",
        },
        "Myopic HES": {
            4: "exp_HES_SynGP_1",
            10: "exp_HES_SynGP_1_00",
            9: "exp_HES_SynGP_1_01",
            8: "exp_HES_SynGP_1_02",
            7: "exp_HES_SynGP_1_03",
            2: "exp_HES_SynGP_1_04",
            6: "exp_HES_SynGP_1_05",
            3: "exp_HES_SynGP_1_06",
            5: "exp_HES_SynGP_1_07",
            1: "exp_HES_SynGP_1_08",
        },
        "Non-myopic MST": {
            1: "exp_qMSL_SynGP_3_19",
            2: "exp_qMSL_SynGP_3_20",
            3: "exp_qMSL_SynGP_3_21",
            4: "exp_qMSL_SynGP_3_22",
            5: "exp_qMSL_SynGP_3_23",
            6: "exp_qMSL_SynGP_3_24",
            7: "exp_qMSL_SynGP_3_25",
            8: "exp_qMSL_SynGP_3_26",
            9: "exp_qMSL_SynGP_3_27",
            10: "exp_qMSL_SynGP_3_28",
        },
        "SR": {
            3: "exp_qSR_SynGP_0",
            4: "exp_qSR_SynGP_0_00",
            # 1: "exp_qSR_SynGP_0_01",
            2: "exp_qSR_SynGP_0_02",
            # 5: "exp_qSR_SynGP_0_03",
            7: "exp_qSR_SynGP_0_04",
            # 7: "exp_qSR_SynGP_0_05",
            # 8: "exp_qSR_SynGP_0_06",
            # 9: "exp_qSR_SynGP_0_07",
            9: "exp_qSR_SynGP_0_08",
        },
        "EI": {
            # 1: "exp_qEI_SynGP_0",
            # 2: "exp_qEI_SynGP_0_00",
            # 3: "exp_qEI_SynGP_0_01",
            # 4: "exp_qEI_SynGP_0_02",
            # 5: "exp_qEI_SynGP_0_03",
            # 6: "exp_qEI_SynGP_0_04",
            # 7: "exp_qEI_SynGP_0_05",
            # 8: "exp_qEI_SynGP_0_06",
            # 9: "exp_qEI_SynGP_0_07",
            # 10: "exp_qEI_SynGP_0_08",
            
            1: "exp_qEI_SynGP_0_09",
            2: "exp_qEI_SynGP_0_10",
            3: "exp_qEI_SynGP_0_11",
            4: "exp_qEI_SynGP_0_12",
            5: "exp_qEI_SynGP_0_13",
            6: "exp_qEI_SynGP_0_14",
            7: "exp_qEI_SynGP_0_15",
            8: "exp_qEI_SynGP_0_16",
            9: "exp_qEI_SynGP_0_17",
            10: "exp_qEI_SynGP_0_18",
        },
        "PI": {
            # 1: "exp_qPI_SynGP_0",
            # 2: "exp_qPI_SynGP_0_00",
            # 3: "exp_qPI_SynGP_0_01",
            # 4: "exp_qPI_SynGP_0_02",
            # 5: "exp_qPI_SynGP_0_03",
            # 6: "exp_qPI_SynGP_0_04",
            # 7: "exp_qPI_SynGP_0_05",
            # 8: "exp_qPI_SynGP_0_06",
            # 9: "exp_qPI_SynGP_0_07",
            # 10: "exp_qPI_SynGP_0_08",
            
            1: "exp_qPI_SynGP_0_09",
            2: "exp_qPI_SynGP_0_10",
            3: "exp_qPI_SynGP_0_11",
            4: "exp_qPI_SynGP_0_12",
            5: "exp_qPI_SynGP_0_13",
            6: "exp_qPI_SynGP_0_14",
            7: "exp_qPI_SynGP_0_15",
            8: "exp_qPI_SynGP_0_16",
            9: "exp_qPI_SynGP_0_17",
            10: "exp_qPI_SynGP_0_18",
        },
        "UCB": {
            # 1: "exp_qUCB_SynGP_0",
            # 2: "exp_qUCB_SynGP_0_00",
            # 3: "exp_qUCB_SynGP_0_01",
            # 4: "exp_qUCB_SynGP_0_02",
            # 5: "exp_qUCB_SynGP_0_03",
            # 6: "exp_qUCB_SynGP_0_04",
            # 7: "exp_qUCB_SynGP_0_05",
            # 8: "exp_qUCB_SynGP_0_06",
            # 9: "exp_qUCB_SynGP_0_07",
            # 10: "exp_qUCB_SynGP_0_08",
            
            1: "exp_qUCB_SynGP_0_09",
            2: "exp_qUCB_SynGP_0_10",
            3: "exp_qUCB_SynGP_0_11",
            4: "exp_qUCB_SynGP_0_12",
            5: "exp_qUCB_SynGP_0_13",
            6: "exp_qUCB_SynGP_0_14",
            7: "exp_qUCB_SynGP_0_15",
            8: "exp_qUCB_SynGP_0_16",
            9: "exp_qUCB_SynGP_0_17",
            10: "exp_qUCB_SynGP_0_18",
        },
        "KG": {
            # 1: "exp_qKG_SynGP_0",
            # 2: "exp_qKG_SynGP_0_00",
            # 3: "exp_qKG_SynGP_0_01",
            # 4: "exp_qKG_SynGP_0_02",
            # 5: "exp_qKG_SynGP_0_03",
            # 6: "exp_qKG_SynGP_0_04",
            # 7: "exp_qKG_SynGP_0_05",
            # 8: "exp_qKG_SynGP_0_06",
            # 9: "exp_qKG_SynGP_0_07",
            # 10: "exp_qKG_SynGP_0_08",
            
            1: "exp_qKG_SynGP_0_09",
            2: "exp_qKG_SynGP_0_10",
            3: "exp_qKG_SynGP_0_11",
            4: "exp_qKG_SynGP_0_12",
            5: "exp_qKG_SynGP_0_13",
            6: "exp_qKG_SynGP_0_14",
            7: "exp_qKG_SynGP_0_15",
            8: "exp_qKG_SynGP_0_16",
            9: "exp_qKG_SynGP_0_17",
            10: "exp_qKG_SynGP_0_18",
        }
    },
    "HolderTable": {
        "Non-myopic HES": {
            4: "exp_HES_HolderTable_15",
            6: "exp_HES_HolderTable_15_01",
            5: "exp_HES_HolderTable_15_03",
            2: "exp_HES_HolderTable_15_04",
            3: "exp_HES_HolderTable_15_06",
            10: "exp_HES_HolderTable_15_07",
            7: "exp_HES_HolderTable_15_09",
            9: "exp_HES_HolderTable_15_10",
            8: "exp_HES_HolderTable_15_11",
            1: "exp_HES_HolderTable_15_12",
        },
        "Myopic HES": {
            4: "exp_HES_HolderTable_1",
            8: "exp_HES_HolderTable_1_00",
            3: "exp_HES_HolderTable_1_01",
            7: "exp_HES_HolderTable_1_02",
            6: "exp_HES_HolderTable_1_03",
            1: "exp_HES_HolderTable_1_04",
            9: "exp_HES_HolderTable_1_05",
            10: "exp_HES_HolderTable_1_06",
            5: "exp_HES_HolderTable_1_07",
            2: "exp_HES_HolderTable_1_08",
        },
        "Non-myopic MST": {
            1: "exp_qMSL_HolderTable_3_09",
            2: "exp_qMSL_HolderTable_3_10",
            3: "exp_qMSL_HolderTable_3_11",
            4: "exp_qMSL_HolderTable_3_12",
            5: "exp_qMSL_HolderTable_3_13",
            6: "exp_qMSL_HolderTable_3_14",
            7: "exp_qMSL_HolderTable_3_15",
            8: "exp_qMSL_HolderTable_3_16",
            9: "exp_qMSL_HolderTable_3_17",
            10: "exp_qMSL_HolderTable_3_18",
        },
        "SR": {
            1: "exp_qSR_HolderTable_0",
            2: "exp_qSR_HolderTable_0_00",
            3: "exp_qSR_HolderTable_0_01",
            4: "exp_qSR_HolderTable_0_02",
            5: "exp_qSR_HolderTable_0_03",
            6: "exp_qSR_HolderTable_0_04",
            7: "exp_qSR_HolderTable_0_05",
            8: "exp_qSR_HolderTable_0_06",
            9: "exp_qSR_HolderTable_0_07",
            10: "exp_qSR_HolderTable_0_08",
        },
        "EI": {
            1: "exp_qEI_HolderTable_0",
            2: "exp_qEI_HolderTable_0_00",
            3: "exp_qEI_HolderTable_0_01",
            4: "exp_qEI_HolderTable_0_02",
            5: "exp_qEI_HolderTable_0_03",
            6: "exp_qEI_HolderTable_0_04",
            7: "exp_qEI_HolderTable_0_05",
            8: "exp_qEI_HolderTable_0_06",
            9: "exp_qEI_HolderTable_0_07",
            10: "exp_qEI_HolderTable_0_08",
        },
        "PI": {
            1: "exp_qPI_HolderTable_0",
            2: "exp_qPI_HolderTable_0_00",
            3: "exp_qPI_HolderTable_0_01",
            4: "exp_qPI_HolderTable_0_02",
            5: "exp_qPI_HolderTable_0_03",
            6: "exp_qPI_HolderTable_0_04",
            7: "exp_qPI_HolderTable_0_05",
            8: "exp_qPI_HolderTable_0_06",
            9: "exp_qPI_HolderTable_0_07",
            10: "exp_qPI_HolderTable_0_08",
        },
        "UCB": {
            1: "exp_qUCB_HolderTable_0",
            2: "exp_qUCB_HolderTable_0_00",
            3: "exp_qUCB_HolderTable_0_01",
            4: "exp_qUCB_HolderTable_0_02",
            5: "exp_qUCB_HolderTable_0_03",
            6: "exp_qUCB_HolderTable_0_04",
            7: "exp_qUCB_HolderTable_0_05",
            8: "exp_qUCB_HolderTable_0_06",
            9: "exp_qUCB_HolderTable_0_07",
            10: "exp_qUCB_HolderTable_0_08",
        },
        "KG": {
            1: "exp_qKG_HolderTable_0",
            2: "exp_qKG_HolderTable_0_00",
            3: "exp_qKG_HolderTable_0_01",
            4: "exp_qKG_HolderTable_0_02",
            5: "exp_qKG_HolderTable_0_03",
            6: "exp_qKG_HolderTable_0_04",
            7: "exp_qKG_HolderTable_0_05",
            8: "exp_qKG_HolderTable_0_06",
            9: "exp_qKG_HolderTable_0_07",
            10: "exp_qKG_HolderTable_0_08",
        }
    },
    "EggHolder": {
        "Non-myopic HES": {
            1: "exp_021",
            2: "exp_021_00",
            3: "exp_021_01",
            4: "exp_021_02",
            5: "exp_021_03",
            6: "exp_021_04",
            7: "exp_021_08",
            8: "exp_021_05",
            9: "exp_021_06",
            10: "exp_021_07",
        },
        "Myopic HES": {
            1: "exp_022",
            2: "exp_022_00",
            3: "exp_022_01",
            4: "exp_022_02",
            5: "exp_022_03",
            6: "exp_022_04",
            7: "exp_022_05",
            8: "exp_022_06",
            9: "exp_022_07",
            10: "exp_022_08",
        },
        "Non-myopic MST": {
            1: "exp_023",
            2: "exp_023_00",
            3: "exp_023_01",
            4: "exp_023_02",
            5: "exp_023_03",
            6: "exp_023_04",
            7: "exp_023_05",
            8: "exp_023_06",
            9: "exp_023_07",
            10: "exp_023_08",
        },
        "SR": {
            1: "exp_024",
            2: "exp_024_01",
            3: "exp_024_02",
            4: "exp_024_03",
            5: "exp_024_04",
            6: "exp_024_05",
            7: "exp_024_06",
            8: "exp_024_07",
            9: "exp_024_08",
            10: "exp_024_09",
        },
        "EI": {
            1: "exp_025",
            2: "exp_025_00",
            3: "exp_025_01",
            4: "exp_025_02",
            5: "exp_025_03",
            6: "exp_025_04",
            7: "exp_025_05",
            8: "exp_025_06",
            9: "exp_025_07",
            10: "exp_025_08",
        },
        "PI": {
            1: "exp_026",
            2: "exp_026_00",
            3: "exp_026_01",
            4: "exp_026_02",
            5: "exp_026_03",
            6: "exp_026_04",
            7: "exp_026_05",
            8: "exp_026_06",
            9: "exp_026_07",
            10: "exp_026_08",
        },
        "UCB": {
            1: "exp_027",
            2: "exp_027_00",
            3: "exp_027_01",
            4: "exp_027_02",
            5: "exp_027_03",
            6: "exp_027_04",
            7: "exp_027_05",
            8: "exp_027_06",
            9: "exp_027_07",
            10: "exp_027_08",
        },
        "KG": {
            1: "exp_028",
            2: "exp_028_00",
            3: "exp_028_01",
            4: "exp_028_02",
            5: "exp_028_03",
            6: "exp_028_04",
            7: "exp_028_05",
            8: "exp_028_06",
            9: "exp_028_07",
            10: "exp_028_08",
        }
    }, 
    "Alpine": {
        "Non-myopic HES": {
            7: "exp_HES_Alpine_15_49",
            # 8: "exp_HES_Alpine_15_50",
            4: "exp_HES_Alpine_15_51",
            # 1: "exp_HES_Alpine_15_52",
            6: "exp_HES_Alpine_15_53",
            # 7: "exp_HES_Alpine_15_54",
            10: "exp_HES_Alpine_15_55",
            2: "exp_HES_Alpine_15_56",
            3: "exp_HES_Alpine_15_57",
            5: "exp_HES_Alpine_15_58",
        },
        "Myopic HES": {
            1: "exp_HES_Alpine_1",
            4: "exp_HES_Alpine_1_00",
            3: "exp_HES_Alpine_1_01",
            2: "exp_HES_Alpine_1_02",
            7: "exp_HES_Alpine_1_03",
            8: "exp_HES_Alpine_1_04",
            5: "exp_HES_Alpine_1_05",
            6: "exp_HES_Alpine_1_06",
            9: "exp_HES_Alpine_1_07",
            10: "exp_HES_Alpine_1_08",
        },
        "Non-myopic MST": {
            1: "exp_qMSL_Alpine_3",
            2: "exp_qMSL_Alpine_3_00",
            3: "exp_qMSL_Alpine_3_01",
            4: "exp_qMSL_Alpine_3_02",
            5: "exp_qMSL_Alpine_3_03",
            6: "exp_qMSL_Alpine_3_04",
            7: "exp_qMSL_Alpine_3_05",
            8: "exp_qMSL_Alpine_3_06",
            9: "exp_qMSL_Alpine_3_07",
            10: "exp_qMSL_Alpine_3_08",
        },
        "SR": {
            9: "exp_qSR_Alpine_0",
            10: "exp_qSR_Alpine_0_00",
            6: "exp_qSR_Alpine_0_01",
            7: "exp_qSR_Alpine_0_02",
            8: "exp_qSR_Alpine_0_03",
            # 5: "exp_qSR_Alpine_0_04",
            2: "exp_qSR_Alpine_0_05",
            3: "exp_qSR_Alpine_0_06",
            4: "exp_qSR_Alpine_0_07",
            1: "exp_qSR_Alpine_0_08",
        },
        "EI": {
            1: "exp_qEI_Alpine_0",
            2: "exp_qEI_Alpine_0_00",
            3: "exp_qEI_Alpine_0_01",
            4: "exp_qEI_Alpine_0_02",
            5: "exp_qEI_Alpine_0_03",
            6: "exp_qEI_Alpine_0_04",
            7: "exp_qEI_Alpine_0_05",
            8: "exp_qEI_Alpine_0_06",
            9: "exp_qEI_Alpine_0_07",
            10: "exp_qEI_Alpine_0_08",
        },
        "PI": {
            1: "exp_qPI_Alpine_0",
            2: "exp_qPI_Alpine_0_00",
            3: "exp_qPI_Alpine_0_01",
            4: "exp_qPI_Alpine_0_02",
            5: "exp_qPI_Alpine_0_03",
            6: "exp_qPI_Alpine_0_04",
            7: "exp_qPI_Alpine_0_05",
            8: "exp_qPI_Alpine_0_06",
            9: "exp_qPI_Alpine_0_07",
            10: "exp_qPI_Alpine_0_08",
        },
        "UCB": {
            1: "exp_qUCB_Alpine_0",
            2: "exp_qUCB_Alpine_0_00",
            3: "exp_qUCB_Alpine_0_01",
            4: "exp_qUCB_Alpine_0_02",
            5: "exp_qUCB_Alpine_0_03",
            6: "exp_qUCB_Alpine_0_04",
            7: "exp_qUCB_Alpine_0_05",
            8: "exp_qUCB_Alpine_0_06",
            9: "exp_qUCB_Alpine_0_07",
            10: "exp_qUCB_Alpine_0_08",
        },
        "KG": {
            1: "exp_qKG_Alpine_0",
            2: "exp_qKG_Alpine_0_00",
            3: "exp_qKG_Alpine_0_01",
            4: "exp_qKG_Alpine_0_02",
            5: "exp_qKG_Alpine_0_03",
            6: "exp_qKG_Alpine_0_04",
            7: "exp_qKG_Alpine_0_05",
            8: "exp_qKG_Alpine_0_06",
            9: "exp_qKG_Alpine_0_07",
            10: "exp_qKG_Alpine_0_08",
        }
    }
}
    
dict_metrics = {}
for dataset in datasets:
    list_metrics = []
    for i, algo in enumerate(algos):
        print(f"Dataset: {dataset}, Algo: {algo}")
        
        algo_metrics = []
        for _, seed in enumerate(seeds):
            if seed not in metric_files[dataset][algo]:
                continue
            file_name = f"results/{metric_files[dataset][algo][seed]}/metrics.pkl"
            metrics = pickle.load(open(file_name, "rb"))
            
            algo_metrics.append(metrics[f"eval_metric_{algos_name[i]}_{seed}"])
        
        algo_metrics = np.array(algo_metrics)
        list_metrics.append(algo_metrics)
        
    dict_metrics[dataset] = list_metrics

draw_metric("results", dict_metrics, datasets, algos, num_initial_points=num_initial_points, num_steps=num_steps)